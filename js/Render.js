"use strict";function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function _classCallCheck(e,t){if(!_instanceof(e,t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var Render=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"itemPreview",value:function(e,t,n,a,c,o,i,r,d,s){var l=8<arguments.length&&void 0!==d?d:"",u=9<arguments.length&&void 0!==s?s:"",m=document.createElement("div"),p=document.createElement("img"),f=document.createElement("p"),g=document.createElement("p"),h=document.createElement("span"),v=document.createElement("a"),_="".concat(document.location.origin+document.location.pathname,"?id=").concat(r);p.src=a,p.alt="img",m.appendChild(p),f.classList.add("views"),f.innerText="".concat(o," ").concat(o%10==1?"просмотр":o%10<5&&o%10!=0?"просмотра":"просмотров"),m.appendChild(f),this.rating(m,i.rating,i.imgUrlNotActive,i.imgUrlActive),v.href=_,v.innerHTML="<h3>".concat(t," ").concat(u,"</h3>"),m.appendChild(v),g.innerText=n,m.appendChild(g),this.button(m,_,"Подробнее","button"),h.innerText=c.join(", "),m.appendChild(h),l&&m.classList.add(l),e.appendChild(m)}},{key:"button",value:function(e,t,n){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"",c=document.createElement("button"),o=document.createElement("a");o.href=t,o.innerHTML=n,c.appendChild(o),a&&c.classList.add(a),e.appendChild(c)}},{key:"pageNums",value:function(e,t,n,a){0===a&&(a=1);var c,o=document.createElement("a"),i=1,r=document.location.origin+document.location.pathname+"?";document.location.search.replace("?","").split("&").forEach(function(e){return""!==e&&void("page"!==e.substr(0,4)?r+=e+"&":i=parseInt(e.substr(5)))}),(a<i||0===i)&&(i=a),n<t&&(e.innerHTML+='<a \n        class="flip-far-left" \n        href="'.concat(r,"page=").concat(n<i?i-4:1,'"><div></div>\n      </a>'),e.innerHTML+='<a \n        class="flip-one-left" \n        href="'.concat(r,"page=").concat(i-1,'"><div></div>\n      </a>'),e.innerHTML+='<a href="'.concat(r,'page=1">1</a><span>...</span>'));for(var d=t;d<t+n&&d<=a;d++)o.innerText=String(d),o.href=r+"page=".concat(d),c=d,e.innerHTML+=o.outerHTML;c!==a&&(e.innerHTML+=(c+1!==a?"<span>...</span>":"")+'<a href="'.concat(r,"page=").concat(a,'">').concat(a,"</a>"),e.innerHTML+='<a \n        class="flip-one-right" \n        href="'.concat(r,"page=").concat(i+1,'"><div></div>\n      </a>'),e.innerHTML+='<a \n        class="flip-far-right" \n        href="'.concat(r,"page=").concat(i+4<=a?i+4:a,'"><div></div>\n      </a>'))}},{key:"rating",value:function(e,t,n,a,c){var i=this,o=4<arguments.length&&void 0!==c&&c,r=document.createElement("div"),d=document.createElement("div");r.classList.add("rating"),d.classList.add("rating__item");for(var s,l=0;l<5;l++){d.dataset.index=String(l+1),d.dataset.index<=Math.floor(t)?d.style.backgroundImage="url(".concat(a,")"):d.style.backgroundImage="url(".concat(n,")");var u,m,p,f=t-Math.floor(t);Number(d.dataset.index)===Math.floor(t)+1?(u=d.cloneNode(!0),m=document.createElement("div"),(p=document.createElement("div")).style.backgroundImage="url(".concat(a,")"),p.style.width="".concat(100/(100*f)*100,"%"),p.style.height="100%",m.appendChild(p),m.style.width="".concat(100*f,"%"),m.style.height="100%",m.style.overflow="hidden",u.appendChild(m),r.innerHTML+=u.outerHTML):r.innerHTML+=d.outerHTML}o&&(s=document.location.href.includes("resourcepacks")?"resourcepacks":"mods",r.onmouseover=function(e){var t;(e.target.classList.contains("rating__item")||e.target.parentNode.parentNode.classList.contains("rating__item"))&&(t=e.target.dataset.index||e.target.parentNode.parentNode.dataset.index,r.childNodes.forEach(function(e){e.dataset.index<=t&&e.classList.add("rating__active-item")}))},r.onmouseout=function(){r.childNodes.forEach(function(e){e.classList.remove("rating__active-item")})},r.childNodes.forEach(function(o){o.onclick=function(){var e,t,n,a,c=document.location.href.includes("resourcepacks")?"".concat(document.location.origin+document.location.pathname,"setRatingRp.php"):"".concat(document.location.origin+document.location.pathname,"setRatingMod.php");localStorage.getItem(s+"_ratings")&&JSON.parse(localStorage.getItem(s+"_ratings"))["item".concat(i.getItemId())]?(e=JSON.parse(localStorage.getItem(s+"_ratings"))["item".concat(i.getItemId())])!==(t=o.dataset.index)&&(n="data="+JSON.stringify({change:!0,oldUserRating:e,newUserRating:t,itemId:i.getItemId()}),i.confirm("Сменить вашу оценку ".concat(e," на ").concat(t,"?"),n,c,"".concat(t),"confirm")):(a="data="+JSON.stringify({change:!1,rating:o.dataset.index,itemId:i.getItemId()}),i.confirm("Поставить оценку ".concat(o.dataset.index,"?"),a,c,"".concat(o.dataset.index),"confirm"))}})),e.appendChild(r)}},{key:"noMatches",value:function(e){e.innerHTML+='<p class="no-matches">Не найдено ни одного совпадения</p>'}},{key:"confirm",value:function(e,t,n,a,c){var o,i,r,d,s=this,l=4<arguments.length&&void 0!==c?c:"";this.issetConfirmBlock||(this.issetConfirmBlock=!0,o=document.createElement("div"),i=document.createElement("p"),r=document.createElement("button"),d=document.createElement("button"),i.innerText=e,o.appendChild(i),r.innerText="Да",d.innerText="Нет",o.appendChild(r),o.appendChild(d),l&&(o.classList.add(l),i.classList.add("".concat(l,"__title")),r.classList.add("".concat(l,"__agree")),d.classList.add("".concat(l,"__refuse"))),r.onclick=function(){var e=new XMLHttpRequest;e.open("POST",n,!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(t),s.addRating(a),o.remove(),s.issetConfirmBlock=!1},d.onclick=function(){o.remove(),s.issetConfirmBlock=!1},document.body.appendChild(o))}},{key:"getItemId",value:function(){var t;return document.location.search.replace("?","").split("&").forEach(function(e){"id"===e.substr(0,2)&&(t=e.substr(3))}),t}},{key:"addRating",value:function(e){var t=document.location.href.includes("resourcepacks")?"resourcepacks":"mods",n=JSON.parse(localStorage.getItem(t+"_ratings"))||{};n["item".concat(this.getItemId())]=e,localStorage.setItem(t+"_ratings",JSON.stringify(n))}}]),e}();